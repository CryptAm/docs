---
title: "Popup Tips"
---


## Обзор
Когда подключен Base Account (смарт-аккаунт) и Coinbase Wallet SDK получает запрос, он открывает сайт 
[keys.coinbase.com](https://keys.coinbase.com/) во всплывающем окне (popup) и передает запрос в это окно для обработки.
При работе со всплывающим окном Base Account учитывайте следующие моменты.

## Поведение блокировки по умолчанию
- Большинство современных браузеров по умолчанию блокируют все всплывающие окна, если они не вызваны кликом пользователя.
- Если окно заблокировано, браузер показывает пользователю уведомление, позволяя управлять настройками всплывающих окон.

### Что с этим делать
- Убедитесь, что между кликом по кнопке и запросом на открытие окна Base Account нет дополнительной логики, так как браузеры могут воспринимать такой запрос как программно инициированный.
- Если логика неизбежна, сведите ее к минимуму и тщательно тестируйте во всех поддерживаемых браузерах.


## `Cross-Origin-Opener-Policy` 
Если окно Base Account открывается и показывает ошибку или бесконечный спиннер, это может быть связано с заголовком `Cross-Origin-Opener-Policy` вашего dapp. Убедитесь, что используется директива, которая позволяет окну Base Account функционировать.

- ✅ Позволяет работать окну Base Account
  - `unsafe-none` (по умолчанию)
  - `same-origin-allow-popups` (рекомендуется)
- ❌ Ломает работу окна Base Account
  - `same-origin`

Для получения более подробной информации обратитесь к [документации MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy).


## Поведение окна Base Account: "задержка" перед закрытием
- Иногда dapp может программно отправлять последующий запрос на основе ответа на предыдущий запрос. Обычно браузеры блокируют такие программные запросы на открытие всплывающих окон.
- Чтобы решить эту проблему, после того как окно Base Account ответит на запрос, оно будет оставаться открытым в течение 200 мс, "прислушиваясь" к возможному следующему входящему запросу, прежде чем закрыться.
  - Если запрос получен в течение этого 200-миллисекундного интервала, он будет принят и обработан в том же самом всплывающем окне.
  - Если запрос получен после истечения 200 мс и окно уже закрылось, попытка открыть окно Base Account будет заблокирована браузером.
 
